# ğŸ“¦ íŒ¨í‚¤ì§€ ë°°í¬ ê°€ì´ë“œ

## ğŸ”„ ë°°í¬ ì›Œí¬í”Œë¡œìš° íë¦„

### ì „ì²´ íë¦„ë„

```mermaid
graph TD
    A[ê°œë°œì ì½”ë“œ ë³€ê²½] --> B[Release ë¸Œëœì¹˜ ìƒì„±/í‘¸ì‹œ]
    B --> C[GitHub Actions íŠ¸ë¦¬ê±°]
    C --> D[ë³€ê²½ì  ê°ì§€]
    D --> E[ì˜ì¡´ì„± ì„¤ì¹˜]
    E --> F[ë¹Œë“œ - í˜„ì¬ ë²„ì „]
    F --> G{í™˜ê²½ë³„ ì „ëµ}
    
    G -->|Dev/Stage| H[ë³€ê²½ëœ íŒ¨í‚¤ì§€ë§Œ ë²„ì „ì—…]
    G -->|Prod| I[ë¸Œëœì¹˜ ê¸°ì¤€ ì „ì²´ ë²„ì „ ì„¤ì •]
    
    H --> J[Pre-release ë°°í¬]
    I --> K[Production ë°°í¬]
    
    J --> L[alpha/beta íƒœê·¸]
    K --> M[latest íƒœê·¸]
    
    L --> N[Dev/Stage ë ˆì§€ìŠ¤íŠ¸ë¦¬]
    M --> O[Prod ë ˆì§€ìŠ¤íŠ¸ë¦¬]
```

### ìƒì„¸ ë‹¨ê³„ë³„ íë¦„

#### 1ï¸âƒ£ **ì¤€ë¹„ ë‹¨ê³„**
```
ğŸ”§ Setup
â”œâ”€â”€ Checkout ì½”ë“œ
â”œâ”€â”€ Node.js ì„¤ì •
â”œâ”€â”€ pnpm ì„¤ì¹˜
â””â”€â”€ ì˜ì¡´ì„± ì„¤ì¹˜
```

#### 2ï¸âƒ£ **ë³€ê²½ì  ê°ì§€**
```
ğŸ” Change Detection
â”œâ”€â”€ ë§ˆì§€ë§‰ ë¦´ë¦¬ìŠ¤ íƒœê·¸ì™€ ë¹„êµ
â”œâ”€â”€ ë³€ê²½ëœ íŒŒì¼ ë¶„ì„ (src/, package.json)
â””â”€â”€ ì˜í–¥ë°›ì€ íŒ¨í‚¤ì§€ ëª©ë¡ ìƒì„±
```

#### 3ï¸âƒ£ **ë¹Œë“œ (í˜„ì¬ ë²„ì „)**
```
ğŸ—ï¸ Build
â”œâ”€â”€ í˜„ì¬ ë²„ì „ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ë¹Œë“œ
â”œâ”€â”€ ëª¨ë“  ì˜ì¡´ì„± ì¡´ì¬ ë³´ì¥
â””â”€â”€ dist/ ê²°ê³¼ë¬¼ ìƒì„±
```

#### 4ï¸âƒ£ **ë²„ì „ ê´€ë¦¬ (ë¹Œë“œ í›„)**
```
ğŸ“ Version Management
â”œâ”€â”€ Dev/Stage: ë³€ê²½ëœ íŒ¨í‚¤ì§€ë§Œ patch ì¦ë¶„
â”‚   â”œâ”€â”€ changeset ìë™ ìƒì„±
â”‚   â”œâ”€â”€ pre-release ëª¨ë“œ ì§„ì…
â”‚   â””â”€â”€ ê°œë³„ ë²„ì „ ì¦ë¶„ (1.16.6 â†’ 1.16.7-alpha.1)
â”‚
â””â”€â”€ Prod: ë¸Œëœì¹˜ ê¸°ì¤€ ì „ì²´ ë²„ì „
    â””â”€â”€ release/X.Y.Z â†’ X.Y.Z ì„¤ì •
```

#### 5ï¸âƒ£ **ë°°í¬**
```
ğŸš€ Deploy
â”œâ”€â”€ Dev: alpha íƒœê·¸ë¡œ dev ë ˆì§€ìŠ¤íŠ¸ë¦¬
â”œâ”€â”€ Stage: beta íƒœê·¸ë¡œ stage ë ˆì§€ìŠ¤íŠ¸ë¦¬
â””â”€â”€ Prod: latest íƒœê·¸ë¡œ prod ë ˆì§€ìŠ¤íŠ¸ë¦¬
```

---

## ğŸ¯ ê°œë°œì ê°€ì´ë“œ

### ë°°í¬ ë°©ë²•

#### **ë°©ë²• 1: Release ë¸Œëœì¹˜ ë°°í¬ (ê¶Œì¥)**

1. **Release ë¸Œëœì¹˜ ìƒì„±**
   ```bash
   git checkout -b release/1.16.7
   # ì½”ë“œ ìˆ˜ì •
   git commit -m "feat: add new feature"
   git push origin release/1.16.7
   ```

2. **GitHub Actions ì‹¤í–‰**
   - Repository â†’ Actions â†’ "CI - Publish & Build"
   - **Manual trigger** í´ë¦­

3. **í™˜ê²½ ì„ íƒ (Release ë¸Œëœì¹˜)**
   ```json
   {
     "environment": "dev",           // dev, stage, prod
     "services": "package-publish",  // íŒ¨í‚¤ì§€ ë°°í¬
     "manual_version": "",           // ì„ íƒì‚¬í•­: ë¹„ìš°ë©´ ë¸Œëœì¹˜ëª…ì—ì„œ ì¶”ì¶œ (1.16.7)
     "dependency_overrides": "",     // ì„ íƒì‚¬í•­: íŠ¹ì • ì˜ì¡´ì„± ë²„ì „ ì§€ì •
     "dry_run": "false"             // ì‹¤ì œ ë°°í¬ ì—¬ë¶€
   }
   ```

#### **ë°©ë²• 2: Develop ë¸Œëœì¹˜ ë°°í¬**

1. **Develop ë¸Œëœì¹˜ì—ì„œ ì‘ì—…**
   ```bash
   git checkout develop
   # ì½”ë“œ ìˆ˜ì •
   git commit -m "feat: experimental feature"
   git push origin develop
   ```

2. **GitHub Actions ì‹¤í–‰**
   - Repository â†’ Actions â†’ "CI - Publish & Build"
   - **Manual trigger** í´ë¦­

3. **í™˜ê²½ ì„ íƒ (Develop ë¸Œëœì¹˜ - manual_version í•„ìˆ˜)**
   ```json
   {
     "environment": "dev",                    // devë§Œ ê°€ëŠ¥ (ì‹¤í—˜ì  ê¸°ëŠ¥)
     "services": "package-publish",           
     "manual_version": "1.16.7-experiment.1", // í•„ìˆ˜: ë°°í¬í•  ë²„ì „ ì§ì ‘ ì…ë ¥
     "dependency_overrides": "",              
     "dry_run": "false"                      
   }
   ```

#### **ë°©ë²• 3: ìˆ˜ë™ ë²„ì „ ì§€ì • (Release ë¸Œëœì¹˜)**

Release ë¸Œëœì¹˜ì—ì„œ ë¸Œëœì¹˜ëª…ê³¼ ë‹¤ë¥¸ ë²„ì „ìœ¼ë¡œ ë°°í¬í•˜ê³  ì‹¶ì€ ê²½ìš°:
```json
{
  "environment": "dev",
  "services": "package-publish", 
  "manual_version": "1.16.8-hotfix.1",  // ë¸Œëœì¹˜ëª…(1.16.7)ê³¼ ë‹¤ë¥¸ ë²„ì „
  "dry_run": "false"
}
```

#### **ë°©ë²• 4: ì˜ì¡´ì„± ì˜¤ë²„ë¼ì´ë“œ**

íŠ¹ì • ì˜ì¡´ì„± ë²„ì „ì„ ì§€ì •í•˜ê³  ì‹¶ì€ ê²½ìš°:
```json
{
  "environment": "dev",
  "services": "package-publish",
  "dependency_overrides": "{\"@to-nexus/core\":\"1.16.5\",\"viem\":\"2.37.0\"}"
}
```

---

## ğŸŒ¿ ë¸Œëœì¹˜ë³„ ë°°í¬ ì „ëµ

### **Release ë¸Œëœì¹˜** (`release/X.Y.Z`)
- **ë²„ì „ ê²°ì •**: ë¸Œëœì¹˜ëª…ì—ì„œ ìë™ ì¶”ì¶œ (ì˜ˆ: `release/1.16.7` â†’ `1.16.7`)
- **manual_version**: ì„ íƒì‚¬í•­ (ì˜¤ë²„ë¼ì´ë“œ ê°€ëŠ¥)
- **ìš©ë„**: ì •ì‹ ë¦´ë¦¬ìŠ¤ ì¤€ë¹„
- **í™˜ê²½**: dev â†’ stage â†’ prod ìˆœì°¨ ë°°í¬

### **Develop ë¸Œëœì¹˜** (`develop`)
- **ë²„ì „ ê²°ì •**: `manual_version` **í•„ìˆ˜ ì…ë ¥**
- **manual_version**: í•„ìˆ˜ (ì˜ˆ: `1.16.7-experiment.1`)
- **ìš©ë„**: ì‹¤í—˜ì  ê¸°ëŠ¥, í•«í”½ìŠ¤ í…ŒìŠ¤íŠ¸
- **í™˜ê²½**: devë§Œ ê°€ëŠ¥

### **ê¸°íƒ€ ë¸Œëœì¹˜** (`feature/*`, `fix/*` ë“±)
- **ë²„ì „ ê²°ì •**: `manual_version` **í•„ìˆ˜ ì…ë ¥**
- **manual_version**: í•„ìˆ˜ (ì˜ˆ: `1.16.7-feature-auth.1`)
- **ìš©ë„**: ê¸°ëŠ¥ ë¸Œëœì¹˜ í…ŒìŠ¤íŠ¸
- **í™˜ê²½**: devë§Œ ê¶Œì¥

---

## ğŸŒ í™˜ê²½ë³„ ë°°í¬ ì „ëµ

### **Dev í™˜ê²½** ğŸ§ª
- **ëª©ì **: ê°œë°œ/í…ŒìŠ¤íŠ¸
- **ë²„ì „ ì „ëµ**: ë³€ê²½ëœ íŒ¨í‚¤ì§€ë§Œ patch ì¦ë¶„
- **íƒœê·¸**: `alpha` (ì˜ˆ: `1.16.7-alpha.1`)
- **ë ˆì§€ìŠ¤íŠ¸ë¦¬**: `dev-cross-sdk-js`
- **ë¸Œëœì¹˜**: `release/*`

### **Stage í™˜ê²½** ğŸ­
- **ëª©ì **: ìŠ¤í…Œì´ì§•/QA
- **ë²„ì „ ì „ëµ**: ë³€ê²½ëœ íŒ¨í‚¤ì§€ë§Œ patch ì¦ë¶„  
- **íƒœê·¸**: `beta` (ì˜ˆ: `1.16.7-beta.1`)
- **ë ˆì§€ìŠ¤íŠ¸ë¦¬**: `stage-cross-sdk-js`
- **ë¸Œëœì¹˜**: `release/*`

### **Prod í™˜ê²½** ğŸš€
- **ëª©ì **: í”„ë¡œë•ì…˜ ë°°í¬
- **ë²„ì „ ì „ëµ**: ë¸Œëœì¹˜ ê¸°ì¤€ ì „ì²´ ë²„ì „
- **íƒœê·¸**: `latest` (ì˜ˆ: `1.16.7`)
- **ë ˆì§€ìŠ¤íŠ¸ë¦¬**: `cross-sdk-js`
- **ë¸Œëœì¹˜**: `main` ë˜ëŠ” `release/*`

#### **ìš´ì˜ ë°°í¬ ì‹œ íƒœê·¸/ë²„ì „ íë¦„ (`release/1.16.7` ì˜ˆì‹œ):**

```
ğŸŒ¿ ë¸Œëœì¹˜: release/1.16.7
    â†“
ğŸ“ ë²„ì „ ì¶”ì¶œ: 1.16.7 (ë¸Œëœì¹˜ëª…ì—ì„œ)
    â†“  
ğŸ—ï¸ ë¹Œë“œ: í˜„ì¬ ë²„ì „(1.16.6)ìœ¼ë¡œ ë¹Œë“œ
    â†“
ğŸ“ ë²„ì „ ì„¤ì •: ëª¨ë“  íŒ¨í‚¤ì§€ë¥¼ 1.16.7ë¡œ ì„¤ì •
    â†“
ğŸš€ ë°°í¬: @to-nexus/appkit@1.16.7 (latest íƒœê·¸)
    â†“
ğŸ·ï¸ Git íƒœê·¸: release/1.16.7 ìƒì„±
    â†“
ğŸ“‹ GitHub Release: v1.16.7 ìƒì„±
```

**ê²°ê³¼:**
- **NPM íŒ¨í‚¤ì§€**: `@to-nexus/appkit@1.16.7` (latest)
- **Git íƒœê·¸**: `release/1.16.7`  
- **GitHub Release**: `v1.16.7`
- **ë ˆì§€ìŠ¤íŠ¸ë¦¬**: `https://package.cross-nexus.com/repository/cross-sdk-js`

---

## ğŸ“‹ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

### **ë°°í¬ ì „ í™•ì¸ì‚¬í•­**
- [ ] ì½”ë“œ ë¦¬ë·° ì™„ë£Œ
- [ ] í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] ë¸Œëœì¹˜ëª…ì´ `release/X.Y.Z` í˜•ì‹
- [ ] ë³€ê²½ì‚¬í•­ì´ ì˜¬ë°”ë¥¸ íŒ¨í‚¤ì§€ì— í¬í•¨ë¨

### **ë°°í¬ í›„ í™•ì¸ì‚¬í•­**
- [ ] Nexus ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— íŒ¨í‚¤ì§€ ì—…ë¡œë“œ í™•ì¸
- [ ] ì˜¬ë°”ë¥¸ dist-tag ì„¤ì • í™•ì¸ (alpha/beta/latest)
- [ ] ì˜ì¡´ì„± í•´ê²° í…ŒìŠ¤íŠ¸
- [ ] ìƒ˜í”Œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë™ì‘ í™•ì¸

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### **ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œ**

#### **1. ìˆœí™˜ ì°¸ì¡° ì—ëŸ¬**
```
Invalid package dependency graph: cyclic dependency detected
```
**í•´ê²°**: `align-workspace-deps.cjs`ì—ì„œ ì˜ˆì™¸ ì²˜ë¦¬ëœ íŒ¨í‚¤ì§€ í™•ì¸

#### **2. ë²„ì „ ë¶ˆì¼ì¹˜**
```
Package "X" must depend on the current version of "Y"
```
**í•´ê²°**: examplesì˜ workspace ì˜ì¡´ì„± í™•ì¸ (`workspace:*`)

#### **3. ì˜ì¡´ì„± ì„¤ì¹˜ ì‹¤íŒ¨**
```
ERR_PNPM_NO_MATCHING_VERSION
```
**í•´ê²°**: ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì¸ì¦ ë° íŒ¨í‚¤ì§€ ì¡´ì¬ ì—¬ë¶€ í™•ì¸

#### **4. ë¹Œë“œ ì‹¤íŒ¨**
```
Cannot find module '@to-nexus/core'
```
**í•´ê²°**: ì˜ì¡´ì„± ë²„ì „ í™•ì¸ ë° ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„¤ì • ì ê²€

---

## ğŸ›ï¸ ê³ ê¸‰ ì‚¬ìš©ë²•

### **ì„ íƒì  íŒ¨í‚¤ì§€ ë°°í¬**

íŠ¹ì • íŒ¨í‚¤ì§€ë§Œ ë°°í¬í•˜ê³  ì‹¶ì€ ê²½ìš°:
```bash
# 1. í•´ë‹¹ íŒ¨í‚¤ì§€ë§Œ ìˆ˜ì •
# 2. changeset ìƒì„±
pnpm changeset add
# 3. ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ì‹œ ìë™ìœ¼ë¡œ í•´ë‹¹ íŒ¨í‚¤ì§€ë§Œ ë²„ì „ì—…
```

### **í•«í”½ìŠ¤ ë°°í¬**

ê¸´ê¸‰ ìˆ˜ì •ì´ í•„ìš”í•œ ê²½ìš°:
```json
{
  "environment": "prod",
  "services": "package-publish",
  "manual_version": "1.16.7-hotfix.1",
  "dependency_overrides": "{\"@to-nexus/core\":\"1.16.6\"}"
}
```

### **ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì‹œë”©**

ìƒˆë¡œìš´ í™˜ê²½ì— ê¸°ì¡´ íŒ¨í‚¤ì§€ë¥¼ ë³µì‚¬í•˜ëŠ” ê²½ìš°:
```bash
# Bash ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©
./scripts/seed-registry.sh dev
./scripts/seed-registry.sh stage
```

---

## ğŸ“Š ë°°í¬ í˜„í™© í™•ì¸

### **ë ˆì§€ìŠ¤íŠ¸ë¦¬ë³„ íŒ¨í‚¤ì§€ í™•ì¸**
- **Dev**: https://package.cross-nexus.com/repository/dev-cross-sdk-js
- **Stage**: https://package.cross-nexus.com/repository/stage-cross-sdk-js  
- **Prod**: https://package.cross-nexus.com/repository/cross-sdk-js

### **íƒœê·¸ë³„ ë²„ì „ í™•ì¸**
```bash
# íŠ¹ì • íŒ¨í‚¤ì§€ì˜ íƒœê·¸ë³„ ë²„ì „ í™•ì¸
npm view @to-nexus/appkit dist-tags --registry <registry-url>

# ê²°ê³¼ ì˜ˆì‹œ:
# {
#   "latest": "1.16.6",
#   "alpha": "1.16.7-alpha.1", 
#   "beta": "1.16.7-beta.1"
# }
```

---

## ğŸš¨ ì£¼ì˜ì‚¬í•­

### **DO's âœ…**
- ë¸Œëœì¹˜ëª…ì„ `release/X.Y.Z` í˜•ì‹ìœ¼ë¡œ ìƒì„±
- ë³€ê²½ì‚¬í•­ì„ ëª…í™•íˆ ì»¤ë°‹ ë©”ì‹œì§€ì— ê¸°ë¡
- dry_runìœ¼ë¡œ ë¨¼ì € í…ŒìŠ¤íŠ¸
- í™˜ê²½ë³„ ìˆœì°¨ ë°°í¬ (dev â†’ stage â†’ prod)

### **DON'Ts âŒ**
- main ë¸Œëœì¹˜ì—ì„œ ì§ì ‘ ë°°í¬í•˜ì§€ ë§ ê²ƒ
- ìˆ˜ë™ìœ¼ë¡œ package.json ë²„ì „ ìˆ˜ì •í•˜ì§€ ë§ ê²ƒ  
- ìˆœí™˜ ì°¸ì¡°ë¥¼ ìœ ë°œí•˜ëŠ” ì˜ì¡´ì„± ì¶”ê°€í•˜ì§€ ë§ ê²ƒ
- prod í™˜ê²½ì—ì„œ ì‹¤í—˜ì  ê¸°ëŠ¥ ë°°í¬í•˜ì§€ ë§ ê²ƒ

---

## ğŸ“ ì§€ì›

ë°°í¬ ê´€ë ¨ ë¬¸ì œê°€ ë°œìƒí•˜ë©´:
1. GitHub Actions ë¡œê·¸ í™•ì¸
2. Nexus ë ˆì§€ìŠ¤íŠ¸ë¦¬ ìƒíƒœ ì ê²€
3. ì˜ì¡´ì„± ì¶©ëŒ ì—¬ë¶€ í™•ì¸
4. íŒ€ ìŠ¬ë™ ì±„ë„ì— ë¬¸ì˜

---

*ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2025-09-02*
*ë¬¸ì„œ ë²„ì „: 1.0.0*